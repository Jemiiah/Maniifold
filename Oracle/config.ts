import dotenv from "dotenv";

dotenv.config();

export const ORACLE_PRIVATE_KEY = process.env.ORACLE_PRIVATE_KEY || "";
export const ALEO_NODE_URL = process.env.ALEO_NODE_URL || "";
export const ETHERSCAN_API_KEY = process.env.ETHERSCAN_API_KEY || "";

export const PROGRAM_ID = "predictionprivacyhack.aleo";
export const ALEO_BROADCAST_URL = `${ALEO_NODE_URL}/testnet/transaction/broadcast`;

// Costs
export const CREATE_POOL_FEE = 2_000_000;
export const RESOLVE_POOL_FEE = 1_000_000;

// Embedded Program Source (Mock)
export const PROGRAM_SOURCE = `program predictionprivacyhack.aleo;\n\nrecord Prediction:\n    owner as address.private;\n    id as field.private;\n    pool_id as field.private;\n    option as u64.private;\n    amount as u64.private;\n    claimed as boolean.private;\n\nstruct Pool:\n    id as field;\n    title as field;\n    description as field;\n    options as [field; 2u32];\n    deadline as u64;\n    status as u8;\n    winning_option as u64;\n    total_staked as u64;\n    option_a_stakes as u64;\n    option_b_stakes as u64;\n\nstruct Default:\n    id as u32;\n\nmapping pools:\n    key as field.public;\n    value as Pool.public;\n\nmapping total_predictions:\n    key as field.public;\n    value as u64.public;\n\nmapping user_predictions:\n    key as address.public;\n    value as [field; 1u32].public;\n\nmapping pool_predictions:\n    key as field.public;\n    value as [field; 1u32].public;\n\nfunction initialize:\n    async initialize self.caller into r0;\n    output r0 as predictionprivacyhack.aleo/initialize.future;\n\nfinalize initialize:\n    input r0 as address.public;\n    assert.eq true true;\n\nfunction main:\n\nfunction create_pool:\n    input r0 as field.public;\n    input r1 as field.public;\n    input r2 as [field; 2u32].public;\n    input r3 as u64.public;\n    hash.bhp256 r0 into r4 as field;\n    assert.eq self.caller aleo1jl3q3uywtdzlr8dln65xjc2mr7vwa2pm9fsenq49zsgsz5a8pqzs0j7cj5;\n    cast r4 r0 r1 r2 r3 0u8 0u64 0u64 0u64 0u64 into r5 as Pool;\n    async create_pool r4 r5 into r6;\n    output r5 as Pool.private;\n    output r6 as predictionprivacyhack.aleo/create_pool.future;\n\nfinalize create_pool:\n    input r0 as field.public;\n    input r1 as Pool.public;\n    set 0u64 into total_predictions[r0];\n    set r1 into pools[r0];\n    cast r0 into r2 as [field; 1u32];\n    set r2 into pool_predictions[r0];\n\nfunction lock_pool:\n    input r0 as field.public;\n    assert.eq self.caller aleo1jl3q3uywtdzlr8dln65xjc2mr7vwa2pm9fsenq49zsgsz5a8pqzs0j7cj5;\n    async lock_pool r0 into r1;\n    output r1 as predictionprivacyhack.aleo/lock_pool.future;\n\nfinalize lock_pool:\n    input r0 as field.public;\n    get pools[r0] into r1;\n    cast r1.id r1.title r1.description r1.options r1.deadline 1u8 r1.winning_option r1.total_staked r1.option_a_stakes r1.option_b_stakes into r2 as Pool;\n    set r2 into pools[r0];\n\nfunction resolve_pool:\n    input r0 as field.public;\n    input r1 as u64.public;\n    assert.eq self.caller aleo1jl3q3uywtdzlr8dln65xjc2mr7vwa2pm9fsenq49zsgsz5a8pqzs0j7cj5;\n    async resolve_pool r0 r1 into r2;\n    output r2 as predictionprivacyhack.aleo/resolve_pool.future;\n\nfinalize resolve_pool:\n    input r0 as field.public;\n    input r1 as u64.public;\n    get pools[r0] into r2;\n    cast r2.id r2.title r2.description r2.options r2.deadline 2u8 r1 r2.total_staked r2.option_a_stakes r2.option_b_stakes into r3 as Pool;\n    set r3 into pools[r0];\n\nfunction predict:\n    input r0 as field.private;\n    input r1 as u64.private;\n    input r2 as u64.private;\n    input r3 as u64.private;\n    is.eq r1 1u64 into r4;\n    is.eq r1 2u64 into r5;\n    or r4 r5 into r6;\n    assert.eq r6 true;\n    assert.neq r2 0u64;\n    hash.bhp256 r3 into r7 as field;\n    cast self.caller r7 r0 r1 r2 false into r8 as Prediction.record;\n    ternary r4 r2 0u64 into r9;\n    ternary r4 0u64 r2 into r10;\n    async predict r0 r7 r2 r1 r9 r10 into r11;\n    output r8 as Prediction.record;\n    output r11 as predictionprivacyhack.aleo/predict.future;\n\nfinalize predict:\n    input r0 as field.public;\n    input r1 as field.public;\n    input r2 as u64.public;\n    input r3 as u64.public;\n    input r4 as u64.public;\n    input r5 as u64.public;\n    contains pools[r0] into r6;\n    assert.eq r6 true;\n    get pools[r0] into r7;\n    assert.eq r7.status 0u8;\n    cast block.timestamp into r8 as u64;\n    gt r7.deadline r8 into r9;\n    assert.eq r9 true;\n    add r7.total_staked r2 into r10;\n    add r7.option_a_stakes r4 into r11;\n    add r7.option_b_stakes r5 into r12;\n    cast r7.id r7.title r7.description r7.options r7.deadline r7.status r7.winning_option r10 r11 r12 into r13 as Pool;\n    set r13 into pools[r0];\n    cast r1 into r14 as [field; 1u32];\n    set r14 into pool_predictions[r0];\n    get total_predictions[r0] into r15;\n    add r15 1u64 into r16;\n    set r16 into total_predictions[r0];\n\nconstructor:\n    assert.eq program_owner aleo1jl3q3uywtdzlr8dln65xjc2mr7vwa2pm9fsenq49zsgsz5a8pqzs0j7cj5;\n
`;
